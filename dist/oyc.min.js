var H=new DOMParser;function S(t,e){let n=H.parseFromString(`<body><template>${t}</template></body>`,"text/html").querySelector("template").content;return e?n.querySelector(e):n}function M(t,e,n){for(;n.childNodes.length>0;){let r=n.firstChild;t.insertBefore(r,e),r.nodeType===Node.ELEMENT_NODE&&l(r)}}function m(t,e){let n=S(e),r=t.firstChild;if(M(t,r,n),r){for(;r.nextSibling;)t.removeChild(r.nextSibling);t.removeChild(r)}}async function y(t,e,n){let r=await fetch(e,{method:t.toUpperCase()});if(r.ok){let o=await r.text();m(n,o)}}var a=["get","post","put","patch","delete","head"],g=a.flatMap(t=>[`[oyc-${t}]`,`[data-oyc-${t}]`]).join(","),C=["trigger"],v=C.flatMap(t=>[`[oyc-${t}]`,`[data-oyc-${t}]`]).join(",");var O=Object.freeze(new NodeList);function x(t){return t.querySelectorAll?t.querySelectorAll(g+","+v):O}function b(t){let e=document.evaluate('//*[@*[ starts-with(name(), "oyc-on:") or starts-with(name(), "data-oyc-on:") ]]',t,null,4),n=null,r=[];for(;n=e.iterateNext();)r.push(n);return r}function d(t,e){return t.getAttribute(e)||t.getAttribute("data-"+e)}var D="oyc-data";function p(t){return t[D]||{}}function P(t){if(t===void 0)return;let e=parseFloat(t);switch(t.replace(e.toString(),"")){case"ms":return e;case"s":return e*1e3;case"m":return e*6e4;default:console.warn("[OYC] Invalid time interval: "+t);return}}function u(t,e,n,r){if(!r||Object.keys(r).length===0){t.addEventListener(e,n);return}let o=function(s){if(r.delay){setTimeout(()=>{n(s)},r.delay);return}if(r.throttle)throw new Error("Throttle is not yet implemented");if(r.debounce)throw new Error("Debounce is not yet implemented");n(s)};t.addEventListener(e,o,r)}function w(t,e,n){t.removeEventListener(e,n)}var N={event:"click",modifiers:void 0};function f(t){if(!t)return;let e=t.split(" "),n=e[0],r={};for(let o=1;o<e.length;o++){let s=e[o].trim();if(!e[o].trim())continue;switch(s){case"once":case"prevent":case"capture":case"passive":{r[s]=!0;continue}}let i=s.split(":"),c=i[0],L=i[1];switch(c){case"poll":case"delay":case"throttle":case"debounce":{r[c]=P(L);continue}}}return{event:n,modifiers:r}}function E(t,e){let n={...N,...f(d(t,"oyc-trigger"))};u(t,n.event,e,n.modifiers)}function A(t){for(let e=0;e<a.length;e++){let n=d(t,"oyc-"+a[e]);n&&E(t,r=>{y(a[e],n,r.currentTarget)})}}var h=class{ready=document.readyState==="complete";on=u;off=w;getOycData=p;process=T;constructor(){this.ready==!1&&document.addEventListener("readystatechange",e=>{e.target.readyState==="complete"&&(this.ready=!0)}),this.onReady(function(){T(document.body)})}onReady(e){this.ready?e():document.addEventListener("readystatechange",n=>{n.target.readyState==="complete"&&e()})}};function l(t){A(t)}function F(t){I(t),b(t).forEach(e=>{let n=p(e);n.onEventHandlers=[];for(let r=0;r<e.attributes.length;r++){let o=e.attributes[r];if(o.name.startsWith("oyc-on:")||o.name.startsWith("data-oyc-on:")){let s=o.name.slice(o.name.indexOf(":")+1),i=o.value,c=f(d(e,"oyc-trigger"));c?u(e,c.event,window[i],c.modifiers):u(e,s,window[i],void 0),n.onEventHandlers.push({event:s,listener:i})}}})}function I(t){let e=p(t);if(e.onEventHandlers){for(let n=0;n<e.onHandlers.length;n++){let r=e.onHandlers[n];t.removeEventListener(r.event,r.listener)}delete e.onEventHandlers}}function T(t){l(t);let e=x(t);for(let n=0;n<e.length;n++)l(e[n]);F(t)}var $=new h;typeof window<"u"&&(window.oyc=$);export{h as Oyc,$ as oyc,l as processElement};
