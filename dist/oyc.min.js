function p(t){let e=document.evaluate('//*[@*[ starts-with(name(), "oyc-on:") or starts-with(name(), "data-oyc-on:") ]]',t),n=null,r=[];for(;n=e.iterateNext();)r.push(n);return r}function y(t,e){return t.hasAttribute(e)||t.hasAttribute("data-"+e)}function u(t,e){return t.getAttribute(e)||t.getAttribute("data-"+e)}function v(t){if(t===void 0)return;let e=parseFloat(t);switch(t.replace(e,"")){case"ms":return e;case"s":return e*1e3;case"m":return e*6e4;default:console.warn("[OYC] Invalid time interval: "+t);return}}var x="oyc-data",c=["get","post","put","patch","delete","head"],T=c.flatMap(t=>[`[oyc-${t}]`,`[data-oyc-${t}]`]).join(","),A=["trigger"],L=A.flatMap(t=>[`[oyc-${t}]`,`[data-oyc-${t}]`]).join(","),g={event:"click",modifiers:void 0},S=new DOMParser,l=class{ready=document.readyState==="complete";on=d;off=$;getOycData=h;process=m;constructor(){this.ready==!1&&document.addEventListener("readystatechange",e=>{e.target.readyState==="complete"&&(this.ready=!0)}),this.onReady(function(){m(document.body)})}onReady(e){this.ready?e():document.addEventListener("readystatechange",n=>{n.target.readyState==="complete"&&e()})}};async function C(t,e,n){let r=await fetch(e,{method:t.toUpperCase()});if(r.ok){let o=await r.text();M(n,o)}}function w(t,e){let n=S.parseFromString(`<body><template>${t}</template></body>`,"text/html");return w===null?document.createDocumentFragment():e?n.querySelector(e):n.querySelector("template").content}function H(t,e,n){for(;n.childNodes.length>0;){let r=n.firstChild;t.insertBefore(r,e),r.nodeType!==Node.TEXT_NODE&&r.nodeType!==Node.COMMENT_NODE&&f(r)}}function M(t,e){let n=w(e),r=t.firstChild;if(H(t,r,n),r){for(;r.nextSibling;)t.removeChild(r.nextSibling);t.removeChild(r)}}function O(t,e){let n=b(u(t,"oyc-trigger"));n?d(t,n.event,e,n.modifiers):d(t,g.event,e,g.modifiers)}function f(t){for(let e=0;e<c.length;e++)y(t,"oyc-"+c[e])&&O(t,function(n){C(c[e],u(t,"oyc-"+c[e]),n.target)})}function D(t){N(t),p(t).forEach(e=>{let n=h(e);n.onEventHandlers=[];for(let r=0;r<e.attributes.length;r++){let o=e.attributes[r];if(o.name.startsWith("oyc-on:")||o.name.startsWith("data-oyc-on:")){let i=o.name.slice(o.name.indexOf(":")+1),s=o.value,a=b(u(e,"oyc-trigger"));a?d(e,a.event,window[s],a.modifiers):d(e,i,window[s],void 0),n.onEventHandlers.push({event:i,listener:s})}}})}function N(t){let e=h(t);if(e.onEventHandlers){for(let n=0;n<e.onHandlers.length;n++)t.removeEventListener(handler.event,handler.listener);delete e.onEventHandlers}}function d(t,e,n,r){if(!r||Object.keys(r).length===0){t.addEventListener(e,n);return}let o=function(i){if(r.delay){setTimeout(()=>{n(i)},r.delay);return}if(r.throttle)throw new Error("Throttle is not yet implemented");if(r.debounce)throw new Error("Debounce is not yet implemented");n(i)};t.addEventListener(e,o,r)}function $(t,e,n){t.removeEventListener(e,n)}function m(t){f(t);let e=q(t);for(let n=0;n<e.length;n++)f(e[n]);D(t)}function h(t){return t[x]||{}}function q(t){return t.querySelectorAll?t.querySelectorAll(T+","+L):[]}function b(t){if(!t)return;let e=t.split(" "),n=e[0],r={};for(let o=1;o<e.length;o++){let i=e[o].trim();if(!e[o].trim())continue;switch(i){case"once":case"prevent":case"capture":case"passive":{r[i]=!0;continue}}let s=i.split(":"),a=s[0],E=s[1];switch(a){case"poll":case"delay":case"throttle":case"debounce":{r[a]=v(E);continue}}}return{event:n,modifiers:r}}var F=new l;typeof window<"u"&&(window.oyc=F);export{l as Oyc,F as oyc};
