var S=new DOMParser;function C(e,t){let n=S.parseFromString(`<body><template>${e}</template></body>`,"text/html").querySelector("template").content;return t?n.querySelector(t):n}function M(e,t,n){for(;n.childNodes.length>0;){let r=n.firstChild;e.insertBefore(r,t),r.nodeType===Node.ELEMENT_NODE&&p(r)}}function g(e,t){let n=C(t),r=e.firstChild;if(M(e,r,n),r){for(;r.nextSibling;)e.removeChild(r.nextSibling);e.removeChild(r)}}async function v(e,t,n){let r=await fetch(t,{method:e.toUpperCase()});if(r.ok){let o=await r.text();g(n,o)}}var d=["get","post","put","patch","delete","head"],x=d.flatMap(e=>[`[oyc-${e}]`,`[data-oyc-${e}]`]).join(","),O=["trigger"],w=O.flatMap(e=>[`[oyc-${e}]`,`[data-oyc-${e}]`]).join(",");function b(e){return e.querySelectorAll(x+","+w)}function E(e){let t=document.evaluate('//*[@*[ starts-with(name(), "oyc-on:") or starts-with(name(), "data-oyc-on:") ]]',e,null,4),n=null,r=[];for(;n=t.iterateNext();)r.push(n);return r}function l(e,t){return e.getAttribute(t)||e.getAttribute("data-"+t)}var D="oyc-data";function h(e){return e[D]||{}}function P(e){if(e===void 0)return;let t=parseFloat(e);switch(e.replace(t.toString(),"")){case"ms":return t;case"s":return t*1e3;case"m":return t*6e4;default:console.warn("[OYC] Invalid time interval: "+e);return}}function u(e,t,n,r){if(!r||Object.keys(r).length===0){e.addEventListener(t,n);return}let o=function(i){if(r.delay){setTimeout(()=>{n(i)},r.delay);return}if(r.throttle)throw new Error("Throttle is not yet implemented");if(r.debounce)throw new Error("Debounce is not yet implemented");n(i)};e.addEventListener(t,o,r)}function A(e,t,n){e.removeEventListener(t,n)}var $={event:"click",modifiers:void 0};function m(e){if(!e)return;let t=e.split(" "),n=t[0],r={};for(let o=1;o<t.length;o++){let i=t[o].trim();if(!t[o].trim())continue;switch(i){case"once":case"prevent":case"capture":case"passive":{r[i]=!0;continue}}let s=i.split(":"),c=s[0],a=s[1];switch(c){case"poll":case"delay":case"throttle":case"debounce":{r[c]=P(a);continue}}}return{event:n,modifiers:r}}function L(e,t){let n={...$,...m(l(e,"oyc-trigger"))};u(e,n.event,t,n.modifiers)}function T(e){for(let t=0;t<d.length;t++){let n=l(e,"oyc-"+d[t]);n&&L(e,r=>{v(d[t],n,r.target)})}}var y=class{ready=document.readyState==="complete";on=u;off=A;getOycData=h;process=H;constructor(){this.ready==!1&&document.addEventListener("readystatechange",t=>{t.target.readyState==="complete"&&(this.ready=!0)}),this.onReady(function(){H(document.body)})}onReady(t){this.ready?t():document.addEventListener("readystatechange",n=>{n.target.readyState==="complete"&&t()})}};function p(e){T(e)}function F(e){let t=E(e);for(let n=0;n<t.length;n++){let r=t[n],o=h(r);o.onEventHandlers=[];for(let i=0;i<r.attributes.length;i++){let s=r.attributes[i];if(s.name.startsWith("oyc-on:")||s.name.startsWith("data-oyc-on:")){let c=s.name.slice(s.name.indexOf(":")+1),a=s.value,f=m(l(r,"oyc-trigger"));f?u(r,f.event,window[a],f.modifiers):u(r,c,window[a]),o.onEventHandlers.push({event:c,listener:a})}}}}function H(e){p(e);let t=b(e);for(let n=0;n<t.length;n++)p(t[n]);F(e)}var I=new y;typeof window<"u"&&(window.oyc=I);export{y as Oyc,I as oyc,p as processElement};
