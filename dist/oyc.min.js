function h(t){let e=document.evaluate('//*[@*[ starts-with(name(), "oyc-on:") or starts-with(name(), "data-oyc-on:") ]]',t),n=null,r=[];for(;n=e.iterateNext();)r.push(n);return r}function p(t,e){return t.hasAttribute(e)||t.hasAttribute("data-"+e)}function u(t,e){return t.getAttribute(e)||t.getAttribute("data-"+e)}function y(t){if(t===void 0)return;let e=parseFloat(t);switch(t.replace(e,"")){case"ms":return e;case"s":return e*1e3;case"m":return e*6e4;default:console.warn("[OYC] Invalid time interval: "+t);return}}var b="oyc-data",c=["get","post","put","patch","delete","head"],x=c.flatMap(t=>[`[oyc-${t}]`,`[data-oyc-${t}]`]).join(","),A=["trigger"],L=A.flatMap(t=>[`[oyc-${t}]`,`[data-oyc-${t}]`]).join(","),v={event:"click",modifiers:void 0},l=class{ready=document.readyState==="complete";on=d;off=O;getOycData=f;process=w;constructor(){this.ready==!1&&document.addEventListener("readystatechange",e=>{e.target.readyState==="complete"&&(this.ready=!0)}),this.onReady(function(){w(document.body)})}onReady(e){this.ready?e():document.addEventListener("readystatechange",n=>{n.target.readyState==="complete"&&e()})}};async function H(t,e,n){let r=await fetch(e,{method:t.toUpperCase()});if(r.ok){let o=await r.text();T(n,o)}}function T(t,e){t.innerHTML=e}function S(t,e){let n=E(u(t,"oyc-trigger"));n?d(t,n.event,e,n.modifiers):d(t,v.event,e,v.modifiers)}function g(t){for(let e=0;e<c.length;e++)p(t,"oyc-"+c[e])&&S(t,function(n){H(c[e],u(t,"oyc-"+c[e]),n.target)})}function C(t){M(t),h(t).forEach(e=>{let n=f(e);n.onEventHandlers=[];for(let r=0;r<e.attributes.length;r++){let o=e.attributes[r];if(o.name.startsWith("oyc-on:")||o.name.startsWith("data-oyc-on:")){let s=o.name.slice(o.name.indexOf(":")+1),a=o.value,i=E(u(e,"oyc-trigger"));i?d(e,i.event,window[a],i.modifiers):d(e,s,window[a],void 0),n.onEventHandlers.push({event:s,listener:a})}}})}function M(t){let e=f(t);if(e.onEventHandlers){for(let n=0;n<e.onHandlers.length;n++)t.removeEventListener(handler.event,handler.listener);delete e.onEventHandlers}}function d(t,e,n,r){if(!r||Object.keys(r).length===0){t.addEventListener(e,n);return}let o=function(s){if(r.delay){setTimeout(()=>{n(s)},r.delay);return}if(r.throttle)throw new Error("Throttle is not yet implemented");if(r.debounce)throw new Error("Debounce is not yet implemented");n(s)};t.addEventListener(e,o,r)}function O(t,e,n){t.removeEventListener(e,n)}function w(t){g(t);let e=D(t);for(let n=0;n<e.length;n++)g(e[n]);C(t)}function f(t){return t[b]||{}}function D(t){return t.querySelectorAll?t.querySelectorAll(x+","+L):[]}function E(t){if(!t)return;let e=t.split(" "),n=e[0],r={};for(let o=1;o<e.length;o++){let s=e[o].trim();if(!e[o].trim())continue;switch(s){case"once":case"prevent":case"capture":case"passive":{r[s]=!0;continue}}let a=s.split(":"),i=a[0],m=a[1];switch(i){case"poll":case"delay":case"throttle":case"debounce":{r[i]=y(m);continue}}}return{event:n,modifiers:r}}var $=new l;typeof window<"u"&&(window.oyc=$);export{l as Oyc,$ as oyc};
